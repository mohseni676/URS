#{extends 'Setup/layout.html' /}
#{set 'title'}&{'urs.setup.title'}#{/set}

<div class="page-header">
<h1 style="text-align:center">&{'urs.setup.header'}</h1>
</div>
<div class="row">
<div class="tabbable span8 offset2">
<ul class="nav nav-tabs" id="SetupTabs">
    <li class="active"><a href="#tab1" data-toggle="tab">&{'urs.setup.tabOne'}</a></li>
    <li><a href="#tab2" data-toggle="tab">&{'urs.setup.tabTwo'}</a></li>
    <li><a href="#tab3" data-toggle="tab">&{'urs.setup.tabThree'}</a></li>    
    <li><a href="#tab4" data-toggle="tab">&{'urs.setup.tabFour'}</a></li>    
</ul>
  <div class="tab-content">
    <div class="tab-pane active" id="tab1">
				<table class="table">
				</tr>
					<td>
			            &{'urs.setup.system.localServerID'}
					</td>
					<td>
				            <input type="text" name="URS.LocalServerID" class="rtl-input span3"  data-title="&{'urs.setup.system.localServerID'}">
					</td>
				</tr>
				</tr>
					<td>
			            &{'urs.setup.system.centralServerAddress'}
					</td>
					<td>
				            <input type="text" name="URS.OntologyUpdateURL" class="ltr-input span3"  data-title="&{'urs.setup.system.centralServerAddress'}">
					</td>
				</tr>
				<tr>
					<td colspan="2">
						<label class="checkbox">
				    		<input type="checkbox" name="URS.LocalOnly" data-title="&{'urs.setup.centralSystem'}" data-show="checkbox">
					    <span style="cursor: pointer;">&{'urs.setup.centralSystem'}</span>
			    		
			    		</label>
					</td>
				</tr>
				</table>
      <a href="#" class="btn" id="next1">&{'urs.setup.continueBtn'}</a>
    </div>
    <div class="tab-pane" id="tab2">
				<table class="table">
				</tr>
					<td>
			            &{'urs.admin.userManagement.newUser.name'}
					</td>
					<td>
					    #{field 'user.name'}
					            <input type="text" name="userName" class="rtl-input span3" data-title="&{'urs.admin.userManagement.newUser.name'}">
					            <span class="error">${field.error}</span>
					    #{/field}
					</td>
				</tr>
				<tr>
					<td>
					    &{'urs.admin.userManagement.newUser.email'}
					</td>
					<td> 
					    #{field 'user.email'}
						<div class="control-group #{ifError 'user.email'}error#{/ifError}">
						  <div class="controls">
							<input type="text" name="userEmail" class="ltr-input span3" data-title="&{'urs.admin.userManagement.newUser.email'}">
						    <span class="help-inline error">${field.error}</span>
						  </div>
						</div>
					    #{/field}
					</td>
				<tr>
					<td>
			            &{'urs.admin.userManagement.newUser.password'}
					</td>
					<td>
					#{field 'user.password'}
						<div class="control-group #{ifError 'user.password'}error#{/ifError}">
						  <div class="controls">
				            <input type="password" name="userPassword" class="ltr-input span3" data-show="no" data-title="&{'urs.admin.userManagement.newUser.password'}">
						    <span class="help-inline error">${field.error}</span>
						  </div>
						</div>
		            #{/field}
					</td>
				</tr>
				<tr>
					<td>
						&{'urs.admin.userManagement.newUser.verifyPassword'}
					</td>
					<td>
					    #{field 'verifyPassword'}
						<div class="control-group #{ifError 'verifyPassword'}error#{/ifError}">
						  <div class="controls">
				            <input type="password" name="verifyPassword" class="ltr-input span3" data-show="no" data-title="&{'urs.admin.userManagement.newUser.verifyPassword'}">
						    <span class="help-inline error">${field.error}</span>
						  </div>
						</div>
					    #{/field}
					</td>
				</tr>
				</table>
      <a href="#" class="btn" id="next2">&{'urs.setup.continueBtn'}</a>
    </div>
    <div class="tab-pane" id="tab3">
	<table class="table">
		<tbody>
			<tr>
				<td>&{'urs.admin.settings.OntologyUpdateInterval'}</td>
				<td>
					<select name="URS.OntologyUpdateInterval" data-title="&{'urs.admin.settings.OntologyUpdateInterval'}">
						<option value="1h">&{'urs.admin.settings.1h'}</option>
						<option value="12h">&{'urs.admin.settings.12h'}</option>
						<option value="24h">&{'urs.admin.settings.1d'}</option>
						<option value="72h">&{'urs.admin.settings.3d'}</option>
						<option value="168h">&{'urs.admin.settings.1w'}</option>
						<option value="720h">&{'urs.admin.settings.1m'}</option>
					</select>
		

				</td>
			</tr>
			<tr>
				<td>&{'urs.admin.settings.UploadKBInterval'}</td>
				<td>
					<select name="URS.UploadKBInterval" data-title="&{'urs.admin.settings.UploadKBInterval'}">
						<option value="1h">&{'urs.admin.settings.1h'}</option>
						<option value="12h">&{'urs.admin.settings.12h'}</option>
						<option value="24h">&{'urs.admin.settings.1d'}</option>
						<option value="72h">&{'urs.admin.settings.3d'}</option>
						<option value="168h">&{'urs.admin.settings.1w'}</option>
						<option value="720h">&{'urs.admin.settings.1m'}</option>
					</select>
				</td>
			</tr>
			<tr>
				<td>&{'urs.admin.settings.OntologyLanguage'}</td>
				<td>
					<select name="URS.OntologyLanguage" data-title="&{'urs.admin.settings.OntologyLanguage'}">
						<option value="fa" selected>&{'urs.admin.settings.fa'}</option>
						<option value="en">&{'urs.admin.settings.en'}</option>
					</select>

				</td>
			</tr>
			<tr>
				<td>&{'urs.admin.settings.InterfaceLanguage'}</td>
				<td>
					<select name="URS.InterfaceLanguage" id="InterfaceLanguage" data-title="&{'urs.admin.settings.InterfaceLanguage'}">
						<option value="fa" selected>&{'urs.admin.settings.fa'}</option>
						<option value="en">&{'urs.admin.settings.en'}</option>
					</select>
				</td>
			</tr>
			<tr>
				<td>&{'urs.admin.settings.CalendarType'}</td>
				<td>
					<select name="URS.CalendarType" id="CalendarType" data-title="&{'urs.admin.settings.CalendarType'}">
						<option value="georgian">&{'urs.admin.settings.georgian'}</option>
						<option value="jalali" selected>&{'urs.admin.settings.jalali'}</option>
					</select>
				</td>
			</tr>
			<tr>
				<td>&{'urs.admin.settings.TreeViewType'}</td>
				<td>
					<select name="URS.TreeViewType" id="TreeViewType" data-title="&{'urs.admin.settings.TreeViewType'}">
						<option value="topdown">&{'urs.admin.settings.topdown'}</option>
						<option value="jqx" selected>&{'urs.admin.settings.jqx'}</option>
						<option value="simple"	>&{'urs.admin.settings.simple'}</option>
					</select>
				</td>
			</tr>
		</tbody>
	</table>
      <a href="#" class="btn" id="next3">&{'urs.setup.continueBtn'}</a>
    </div>
    <div class="tab-pane" id="tab4">
		<div id="setupDataInputs"></div>
		<div id="setupDataSelects"></div>
      	<p><button class="btn disabled btn-primary" id="submitBtn">&{'urs.setup.submitBtn'}</button></p>
      	<p>
      	<label class="checkbox">
      		<input type="checkbox" id="verifyInfo" name="verifyInfo" data-show="no" >
      	&{'urs.setup.tabFour.verify'}
      	</label>
      	</p>
    </div>
  </div>
</div>
</div>

#{set 'moreScripts'}
<script type="text/javascript">
$('#next1').click(function (e) {
  e.preventDefault();
  $('#SetupTabs a[href="#tab2"]').tab('show');
});
$('#next2').click(function (e) {
  e.preventDefault();
  $('#SetupTabs a[href="#tab3"]').tab('show');
});
$('#next3').click(function (e) {
  e.preventDefault();
  $('#SetupTabs a[href="#tab4"]').tab('show');
});
$('#verifyInfo').click(function (e) {
	// e.preventDefault();
	$('#submitBtn').toggleClass('disabled');
});
</script>

<script>
	$(document).ready(function(e){

    $("input").change(function (e) {
          var s = "";
          $("input").each(function () {
	            if($(this).data('show')=="checkbox"){
	            	if($(this).attr('checked')=='checked')
	            		s +="<strong>"+$(this).data('title')+"</strong>: &{'urs.setup.lableYes'}" + "<br/>";
	            	else
	            		s +="<strong>"+$(this).data('title')+"</strong>: &{'urs.setup.lableNo'}" + "<br/>";
            	}else if($(this).data('show')!=="no")
	                s +="<strong>"+$(this).data('title')+"</strong>" + ": " + $(this).val() + "<br/>";
              });
          $("#setupDataInputs").html(s);
        });
        //change();	
    $("select").change(function (e) {
          var s = "";
          $("select option:selected").each(function () {
                s += "<strong>"+$(this).parent().data('title') + "</strong>:  " + $(this).text() + "<br/>";
              });
          $("#setupDataSelects").html(s);
        });
	});
</script>

<script type="text/javascript">
	$(document).ready(function () {
	
	$("#submitBtn").click(function() {
		var jsonObj = {};
        $("select option:selected").each(function () {
             jsonObj[$(this).parent().attr('name')] = $(this).val();
		});
		$("input").each(function () {
			jsonObj[$(this).attr('name')] = $(this).val();			
		});
		var submitVals = JSON.stringify({ "json": jsonObj });
		var request = $.ajax({
						type: "POST",
						url: "@{Setup.configureSystem()}",
						contentType: "application/json; charset=utf-8",
						data: submitVals,
						datatype: "json"
					});

		request.done(function(data, textStatus, jqXHR) {
	    	// xmlHttp is a XMLHttpRquest object
    		// TODO: redirect using window.location.replace("link");
    		window.location.replace("@{Setup.index()}");
		});
	});
	});	

</script>

#{/set}